<!DOCTYPE html>
<html lang="en" dir=" ltr ">

<head>
    <meta name="generator" content="Hugo 0.82.0" /> <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="定义 $  若整数 $n%d=0$，则 $d$ 是 $n$ 的 因数，记为 $d|n$。
算数基本定理 $  任意 $n\in Z^{&#43;}$ 都能唯一分解为有限个质数的乘积：
$$ n=p_1^{c_1}×p_2^{c_2}×&hellip;×p_m^{c_m} \ , \ p_i∈\mathbb{P},c_i\in Z^{&#43;} $$
欧几里得算法 $  最大公因数 $  如何求 $a$ 和 $b$ 的最大公因数？
$gcd(a,b)$ 表示 $a$ 和 $b$ 的最大公因数。
设 $a &gt; b$，$gcd(a, b)=x$，则 $a|x, b|x,(a%b)|x$，
$∴gcd(a,b)=gcd(b,a%b)(a &gt; b &gt; a%b)$。
于是「求 $gcd(a,b)$」的问题被转化为「求 $gcd(b,a%b)$」这一范围更小的问题。当 $b=0$ 时，$a$ 即为最大公因数。
时间复杂度为 $O(log{(a&#43;b)})$。
int gcd(a, b) { if(!b) return a; return gcd(b, a % b); } 最小公倍数 $  如何求 $a$ 和 $b$ 的最小公倍数？"><meta property="og:title" content="因数" />
<meta property="og:description" content="定义 $  若整数 $n%d=0$，则 $d$ 是 $n$ 的 因数，记为 $d|n$。
算数基本定理 $  任意 $n\in Z^{&#43;}$ 都能唯一分解为有限个质数的乘积：
$$ n=p_1^{c_1}×p_2^{c_2}×&hellip;×p_m^{c_m} \ , \ p_i∈\mathbb{P},c_i\in Z^{&#43;} $$
欧几里得算法 $  最大公因数 $  如何求 $a$ 和 $b$ 的最大公因数？
$gcd(a,b)$ 表示 $a$ 和 $b$ 的最大公因数。
设 $a &gt; b$，$gcd(a, b)=x$，则 $a|x, b|x,(a%b)|x$，
$∴gcd(a,b)=gcd(b,a%b)(a &gt; b &gt; a%b)$。
于是「求 $gcd(a,b)$」的问题被转化为「求 $gcd(b,a%b)$」这一范围更小的问题。当 $b=0$ 时，$a$ 即为最大公因数。
时间复杂度为 $O(log{(a&#43;b)})$。
int gcd(a, b) { if(!b) return a; return gcd(b, a % b); } 最小公倍数 $  如何求 $a$ 和 $b$ 的最小公倍数？" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://freeze.org.cn/docs/Math/factor/" /><meta property="article:section" content="docs" />



<title>因数 | Freeze&#39;s Blogs</title>
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.46a4dde4dc554fa8cdae72fbaa505a873b17533a7ffde8fae8e2875889f6fc01.css" integrity="sha256-RqTd5NxVT6jNrnL7qlBahzsXUzp//ej66OKHWIn2/AE=">
<script defer src="/en.search.min.ad414d85f5e10d67aa07eafc4c111cfa3b3caae45d99a3470e0593d09513c096.js" integrity="sha256-rUFNhfXhDWeqB&#43;r8TBEc&#43;js8quRdmaNHDgWT0JUTwJY="></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
--> 
</head>

<body dir=" ltr ">
    <input type="checkbox" class="hidden toggle" id="menu-control" />
    <input type="checkbox" class="hidden toggle" id="toc-control" />
    <main class="container flex">
        <aside class="book-menu">
            <div class="book-menu-content">
                 <nav>
<h2 class="book-brand">
  <a href="/"><img src="/logo.png" alt="Logo" /><span>Freeze&#39;s Blogs</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  



  
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-f4e1054a1a18f4b5cba046970680d31d" class="toggle"  />
    <label for="section-f4e1054a1a18f4b5cba046970680d31d" class="flex justify-between">
      <a  class="">基础算法</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-41ef39c5b40593a842e112d71399835e" class="toggle"  />
    <label for="section-41ef39c5b40593a842e112d71399835e" class="flex justify-between">
      <a  class="">搜索算法</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/Basics/Search/bfs/" class="">BFS（广搜）</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/Basics/Search/dfs/" class="">DFS（深搜）</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/Basics/sort/" class="">排序算法</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/Basics/binary/" class="">二分算法</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/Basics/zip/" class="">状态压缩</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/Basics/hipre/" class="">高精度</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-881053f17f484c85378d3c8abfe12511" class="toggle"  />
    <label for="section-881053f17f484c85378d3c8abfe12511" class="flex justify-between">
      <a  class="">动态规划</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/DP/intro/" class="">简介</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/DP/memo/" class="">记忆化搜索</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/DP/basics/" class="">基础 DP</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/DP/knap/" class="">背包 DP</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/DP/interval/" class="">区间 DP</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/DP/digit/" class="">数位 DP</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/DP/tree/" class="">树形 DP</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/DP/zip/" class="">状压 DP</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-c52067f201458adbb5455083990e4532" class="toggle"  />
    <label for="section-c52067f201458adbb5455083990e4532" class="flex justify-between">
      <a  class="">数据结构</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/DS/intro/" class="">简介</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/DS/stack/" class="">栈</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/DS/link/" class="">链表</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/DS/queue/" class="">队列</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/DS/heap/" class="">二叉堆</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/DS/DSU/" class="">并查集</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/DS/treearray/" class="">树状数组</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/DS/segtree/" class="">线段树</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/DS/ST/" class="">ST 表</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-676d83afa8d0b27104552182cc42cf5c" class="toggle"  />
    <label for="section-676d83afa8d0b27104552182cc42cf5c" class="flex justify-between">
      <a  class="">字符串</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/String/hash/" class="">哈希函数</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/String/hash-map/" class="">哈希表</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/String/KMP/" class="">KMP 算法</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/String/trie/" class="">Trie 树</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/String/AC-atm/" class="">AC 自动机</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-de3a5001ae8b3f900038d0be772141d6" class="toggle"  />
    <label for="section-de3a5001ae8b3f900038d0be772141d6" class="flex justify-between">
      <a  class="">图论</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/Graph/intro/" class="">简介</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/Graph/store/" class="">图的存储</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-51cd7eb0a868c10bd862407a54c9232a" class="toggle"  />
    <label for="section-51cd7eb0a868c10bd862407a54c9232a" class="flex justify-between">
      <a  class="">树</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/Graph/Tree/intro/" class="">简介</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/Graph/Tree/traversal/" class="">树的遍历</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/Graph/Tree/LCA/" class="">最近公共祖先</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/Graph/Tree/MST/" class="">最小生成树</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/Graph/path/" class="">最短路</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/Graph/topsort/" class="">拓扑排序</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/Graph/SCC/" class="">强连通分量</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/Graph/treap/" class="">Treap 平衡树</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-ce95f89a1d24a8066e4c63de0cb15986" class="toggle" checked />
    <label for="section-ce95f89a1d24a8066e4c63de0cb15986" class="flex justify-between">
      <a  class="">数论</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/Math/prime/" class="">质数</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/Math/factor/" class=" active">因数</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/Math/mod/" class="">同余</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/Math/quickpow/" class="">快速幂</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://freeze.org.cn/docs/Tools/" class="">工具</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var a=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>

 
                
            </div>
        </aside>

        <div class="book-page">
            <header class="book-header">
                 <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>因数</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>
 
<aside class="hidden clearfix">
      <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#定义">定义</a>
          <ul>
            <li><a href="#算数基本定理">算数基本定理</a></li>
          </ul>
        </li>
        <li><a href="#欧几里得算法">欧几里得算法</a>
          <ul>
            <li><a href="#最大公因数">最大公因数</a></li>
            <li><a href="#最小公倍数">最小公倍数</a></li>
            <li><a href="#互质数">互质数</a></li>
          </ul>
        </li>
        <li><a href="#分解质因数">分解质因数</a>
          <ul>
            <li><a href="#试除法">试除法</a></li>
            <li><a href="#倍数法">倍数法</a></li>
          </ul>
        </li>
        <li><a href="#欧拉函数">欧拉函数</a>
          <ul>
            <li><a href="#线性欧拉算法">线性欧拉算法</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>  
</aside>
 
                
            </header>

             
<article class="markdown"><h2 id="定义">
  定义
  <a class="anchor" href="#%e5%ae%9a%e4%b9%89">$</a>
</h2>
<p>若整数 $n%d=0$，则 $d$ 是 $n$ 的 <strong>因数</strong>，记为 $d|n$。</p>
<h3 id="算数基本定理">
  算数基本定理
  <a class="anchor" href="#%e7%ae%97%e6%95%b0%e5%9f%ba%e6%9c%ac%e5%ae%9a%e7%90%86">$</a>
</h3>
<p>任意 $n\in Z^{+}$ 都能唯一分解为有限个质数的乘积：</p>
<p>$$
n=p_1^{c_1}×p_2^{c_2}×&hellip;×p_m^{c_m} \ , \ p_i∈\mathbb{P},c_i\in Z^{+}
$$</p>
<h2 id="欧几里得算法">
  欧几里得算法
  <a class="anchor" href="#%e6%ac%a7%e5%87%a0%e9%87%8c%e5%be%97%e7%ae%97%e6%b3%95">$</a>
</h2>
<h3 id="最大公因数">
  最大公因数
  <a class="anchor" href="#%e6%9c%80%e5%a4%a7%e5%85%ac%e5%9b%a0%e6%95%b0">$</a>
</h3>
<p>如何求 $a$ 和 $b$ 的最大公因数？</p>
<p>$gcd(a,b)$ 表示 $a$ 和 $b$ 的最大公因数。</p>
<p>设 $a &gt; b$，$gcd(a, b)=x$，则 $a|x, b|x,(a%b)|x$，</p>
<p>$∴gcd(a,b)=gcd(b,a%b)(a &gt; b &gt; a%b)$。</p>
<p>于是「求 $gcd(a,b)$」的问题被转化为「求 $gcd(b,a%b)$」这一范围更小的问题。当 $b=0$ 时，$a$ 即为最大公因数。</p>
<p>时间复杂度为 $O(log{(a+b)})$。</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">gcd</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">a</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">b</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">if</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">b</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">a</span><span style="color:#000;font-weight:bold">;</span>
    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">gcd</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">b</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">a</span> <span style="color:#ce5c00;font-weight:bold">%</span> <span style="color:#000">b</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h3 id="最小公倍数">
  最小公倍数
  <a class="anchor" href="#%e6%9c%80%e5%b0%8f%e5%85%ac%e5%80%8d%e6%95%b0">$</a>
</h3>
<p>如何求 $a$ 和 $b$ 的最小公倍数？</p>
<p>$lcm(a,b)$ 表示 $a$ 和 $b$ 的最小公倍数。</p>
<p>设 $gcd(a,b)=x$，则有 $a = k_1x,$ $b=k_2x,$ $k_i \in Z^{+}$，</p>
<p>$\displaystyle∴lcm(a,b)=k_1k_2x=\frac{ab}{x}$，即 $\displaystyle lcm(a,b)=\frac{ab}{gcd(a,b)}$。</p>
<p>时间复杂度和 $gcd$ 一致。</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">lcm</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">a</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">b</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">a</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">b</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#000">gcd</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">a</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">b</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h3 id="互质数">
  互质数
  <a class="anchor" href="#%e4%ba%92%e8%b4%a8%e6%95%b0">$</a>
</h3>
<p>公因数只有 $1$ 的一对的整数是互质数。</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#204a87;font-weight:bold">bool</span> <span style="color:#000">isCoprime</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">a</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">b</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">gcd</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">a</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">b</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h2 id="分解质因数">
  分解质因数
  <a class="anchor" href="#%e5%88%86%e8%a7%a3%e8%b4%a8%e5%9b%a0%e6%95%b0">$</a>
</h2>
<p>如何将 $n$ 分解为多个质数相乘的形式（见
  <a href="/docs/Math/factor/#%e7%ae%97%e6%95%b0%e5%9f%ba%e6%9c%ac%e5%ae%9a%e7%90%86">算数基本定理</a>）？</p>
<h3 id="试除法">
  试除法
  <a class="anchor" href="#%e8%af%95%e9%99%a4%e6%b3%95">$</a>
</h3>
<p>判断 $n$ 能否整除 $[2,\sqrt{n}]$ 中的所有整数 $i$，如果能，则从 $n$ 中除掉所有的因子 $i$，并记录因子 $i$ 的个数。时间复杂度为 $O(\sqrt n)$。</p>
<p>样例程序中，$vec[i].first$ 为 $n$ 的第 $i$ 个因数，$vec[i].second$ 为其指数。</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#000">vector</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">pair</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">int</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">int</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">devide</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">n</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000">vector</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">pair</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">int</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">int</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">vec</span><span style="color:#000;font-weight:bold">;</span>
    <span style="color:#204a87;font-weight:bold">for</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;=</span> <span style="color:#000">sqrt</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span><span style="color:#000;font-weight:bold">);</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">if</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span> <span style="color:#ce5c00;font-weight:bold">%</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#000">vec</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">push_back</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">make_pair</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">));</span>
            <span style="color:#204a87;font-weight:bold">while</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span> <span style="color:#ce5c00;font-weight:bold">%</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span>
                <span style="color:#000">n</span> <span style="color:#ce5c00;font-weight:bold">/=</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">vec</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">back</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">second</span> <span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#204a87;font-weight:bold">if</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000">vec</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">push_back</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">make_pair</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">));</span>
    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">vec</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h3 id="倍数法">
  倍数法
  <a class="anchor" href="#%e5%80%8d%e6%95%b0%e6%b3%95">$</a>
</h3>
<p>如何求 $[1,n]$ 中所有整数的因数集合？</p>
<p>用「试除法」很容易超时，此时考虑「倍数法」：</p>
<p>$i$ 一定是 $i·j(j\in Z^{+})$ 的因数。时间复杂度为 $O(nlog{n})$。</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#000">vector</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">vector</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">int</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">factor</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">n</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000">vector</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">vector</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">int</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">vec</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">vector</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">vector</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">int</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#204a87;font-weight:bold">for</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;=</span> <span style="color:#000">n</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span>
        <span style="color:#204a87;font-weight:bold">for</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">j</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">j</span> <span style="color:#ce5c00;font-weight:bold">&lt;=</span> <span style="color:#000">n</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">j</span> <span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span>
            <span style="color:#000">vec</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">j</span><span style="color:#000;font-weight:bold">].</span><span style="color:#000">push_back</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">vec</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h2 id="欧拉函数">
  欧拉函数
  <a class="anchor" href="#%e6%ac%a7%e6%8b%89%e5%87%bd%e6%95%b0">$</a>
</h2>
<p>$n$ 的欧拉函数为 $[1,n]$ 中与 $n$ 互质的数的个数，记为 $\phi(n)$。特别地，$\phi(1)=1$。</p>
<p>如何求 $[1,n]$ 中任意数的欧拉函数？</p>
<p>如果 $p$ 是 $n$ 的质因子，则 $p$ 的所有倍数（$2p,3p,\cdots,$ 共 $\displaystyle\frac{n}{p}$ 个）都不与 $n$ 互质。则可能与 $n$ 互质的数只剩 $\displaystyle n·(1-\frac{1}{p})$ 个。</p>
<p>设 $n$ 的质因子为 $p_1,p_2,\cdots,p_m$，根据乘法原理，有：</p>
<p>$$ \phi(n)=n(1-\frac{1}{p_1})(1-\frac{1}{p_2})\cdots(1-\frac{1}{p_m})=n\prod_{i=1}^{m}(1-\frac{1}{p_i}) $$</p>
<p>时间复杂度为 $O(\sqrt{n})$。</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">phi</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">n</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">ans</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">n</span><span style="color:#000;font-weight:bold">;</span>
    <span style="color:#204a87;font-weight:bold">for</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;=</span> <span style="color:#000">sqrt</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span><span style="color:#000;font-weight:bold">);</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span>
        <span style="color:#204a87;font-weight:bold">if</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span> <span style="color:#ce5c00;font-weight:bold">%</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#000">ans</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">ans</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">-</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">);</span>
            <span style="color:#204a87;font-weight:bold">while</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span> <span style="color:#ce5c00;font-weight:bold">%</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000">n</span> <span style="color:#ce5c00;font-weight:bold">/=</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#204a87;font-weight:bold">if</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span> <span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000">ans</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">ans</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#000">n</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span> <span style="color:#ce5c00;font-weight:bold">-</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">ans</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h3 id="线性欧拉算法">
  线性欧拉算法
  <a class="anchor" href="#%e7%ba%bf%e6%80%a7%e6%ac%a7%e6%8b%89%e7%ae%97%e6%b3%95">$</a>
</h3>
<p>如何求 $[1,n]$ 中所有数的欧拉函数集合？</p>
<p>基于质数的线性筛法进行改写：</p>
<p>若 $a,b$ 互质，则 $\phi(ab)=\phi(a) \cdot \phi(b)$。在线性筛法构造合数 $i \cdot prime[j]$ 时，由于 $i$ 和 $prime[j]$ 互质，令 $phi[i × prime[j]]=phi[i] × phi[prime[j]]$ 。</p>
<p>若 $phi[i] = 0$，则 $i$ 没有被标记过，是质数，令 $phi[i]=i-1$。</p>
<p>当 $i%prime[j]=0$ 时，$i$ 和 $prime[j]$ 不互质，退出循环。</p>
<p>时间复杂度为 $O(n)$。</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#000">vector</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">int</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">phi</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">n</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">if</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">vector</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">int</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">};</span>
    <span style="color:#000">vector</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">int</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">prime</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">phi</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#204a87;font-weight:bold">for</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;=</span> <span style="color:#000">n</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">if</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">phi</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">])</span> <span style="color:#000">phi</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">-</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">prime</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">push_back</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">for</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">j</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">prime</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">j</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">&lt;=</span> <span style="color:#000">n</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">j</span> <span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">if</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">%</span> <span style="color:#000">prime</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">j</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">break</span><span style="color:#000;font-weight:bold">;</span>
            <span style="color:#000">phi</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">prime</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">j</span><span style="color:#000;font-weight:bold">]]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">phi</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">phi</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">prime</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">j</span><span style="color:#000;font-weight:bold">]];</span>
        <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">phi</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div></article>

            
            

            <footer class="book-footer">
                 <div class="flex flex-wrap justify-between">
      
    <div style="margin:0 auto">
        <a href="https://beian.miit.gov.cn/" target="_blank" rel="noopener">
            <span>闽 ICP 备 2021002587 号</span>
        </a>
    </div>
</div> 
                
                
            </footer>

              
            

            <label for="menu-control" class="hidden book-menu-overlay"></label>
        </div>

        
        <aside class="book-toc">
            <div class="book-toc-content">
                  <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#定义">定义</a>
          <ul>
            <li><a href="#算数基本定理">算数基本定理</a></li>
          </ul>
        </li>
        <li><a href="#欧几里得算法">欧几里得算法</a>
          <ul>
            <li><a href="#最大公因数">最大公因数</a></li>
            <li><a href="#最小公倍数">最小公倍数</a></li>
            <li><a href="#互质数">互质数</a></li>
          </ul>
        </li>
        <li><a href="#分解质因数">分解质因数</a>
          <ul>
            <li><a href="#试除法">试除法</a></li>
            <li><a href="#倍数法">倍数法</a></li>
          </ul>
        </li>
        <li><a href="#欧拉函数">欧拉函数</a>
          <ul>
            <li><a href="#线性欧拉算法">线性欧拉算法</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>  
                
            </div>
        </aside>
        
    </main>

    
<link rel="stylesheet" href="/katex/katex.min.css">
<script src="/katex/katex.min.js"></script>
<script src="/katex/auto-render.min.js"></script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [{
                left: "$$",
                right: "$$",
                display: true
            }, {
                left: "$",
                right: "$",
                display: false
            }]
        });
    });
</script>

<script type="text/javascript">
    String.prototype.pxWidth = function(font) {
        var canvas = String.prototype.pxWidth.canvas || (String.prototype.pxWidth.canvas = document.createElement("canvas")),
            context = canvas.getContext("2d"); 
        font && (context.font = font);
        var metrics = context.measureText(this);
        return metrics.width;
    }
    var len = document.getElementsByClassName("book-btn").length;
    for(var i = 0; i < len; i ++) {
        var str = document.getElementsByClassName("book-btn")[i].innerHTML;
        var wid = (100 - str.pxWidth(document.getElementsByClassName("book-btn")[i].style.font)) / 2.3;
        document.getElementsByClassName("book-btn")[i].style.padding = "0 " + wid.toString() + "px";
    }
</script>
</body>

</html>

     